<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>When Architecture Principles Trump Tactical Convenience</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">When Architecture Principles Trump Tactical Convenience</h1>
</header>
<section data-field="subtitle" class="p-summary">
June 16, 2025
</section>
<section data-field="body" class="e-content">
<section name="01e4" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="8cd9" id="8cd9" class="graf graf--h3 graf--leading graf--title">When Architecture Principles Trump Tactical Convenience</h3><p name="edae" id="edae" class="graf graf--p graf-after--h3"><em class="markup--em markup--p-em">June 16, 2025</em></p><figure name="665f" id="665f" class="graf graf--figure graf--startsWithDoubleQuote graf-after--p"><img class="graf-image" data-image-id="1*gwr2KjBuh4q_fvO3ML-y8g.png" data-width="1536" data-height="1024" data-is-featured="true" alt="A person and a robot try to steer a sailboat back on course" src="https://cdn-images-1.medium.com/max/800/1*gwr2KjBuh4q_fvO3ML-y8g.png"><figcaption class="imageCaption">“We’re off-course!”</figcaption></figure><p name="1a63" id="1a63" class="graf graf--p graf--hasDropCapModel graf--hasDropCap graf-after--figure"><span class="graf-dropCap">T</span>here I was, three hours into what should have been a straightforward database migration, watching Claude chase its tail through circular import errors and wondering how we’d gotten so far off track.</p><p name="1c0d" id="1c0d" class="graf graf--p graf-after--p">The goal was simple: create tables for PM-009’s multi-project support. Run the migration script, verify the schema, move on to testing. Classic Monday morning database work.</p><p name="853f" id="853f" class="graf graf--p graf-after--p">Instead, I found myself watching my AI architectural partner violate every design principle we’d established while trying to make broken imports work through increasingly creative workarounds.</p><p name="285f" id="285f" class="graf graf--p graf-after--p">That’s when I realized someone needed to ask the uncomfortable question: “Are we following the stated principles?”</p><h3 name="3b70" id="3b70" class="graf graf--h3 graf-after--p">The setup: when simple tasks become debugging marathons</h3><p name="03b8" id="03b8" class="graf graf--p graf-after--h3">We’d done the hard work on PM-009 already. Domain models designed, business logic implemented, repository patterns established. The migration script should have been mechanical — just translate our SQLAlchemy models into actual database tables.</p><p name="4338" id="4338" class="graf graf--p graf-after--p">I was feeling, well, a little smug! I’d tamed these famously unruly AIs just by using good old fashioned software-development discipline! What could possibly go wrong?</p><p name="5980" id="5980" class="graf graf--p graf-after--p">But the script was failing with duplicate enum values, missing imports, and circular dependencies. Each fix revealed another layer of problems. Classic debugging cascade where every solution creates two new issues.</p><p name="9256" id="9256" class="graf graf--p graf-after--p">By the way, generally when I write “we discovered” or “we realized” in these stories, I mean Claude or Cursor was proposing fixes while I was trying to keep up with why each supposed solution kept breaking something else. But the moment when I stepped back and asked about principles — that came from recognizing we were in a tactical spiral.</p><h3 name="a025" id="a025" class="graf graf--h3 graf-after--p">The first red flag: duplicate enums</h3><p name="9a62" id="9a62" class="graf graf--p graf-after--h3">The migration failed immediately with duplicate <code class="markup--code markup--p-code">CONFIRM_PROJECT</code> entries in our shared types. Not a big deal—just clean up the duplicates and move on, right?</p><p name="ad62" id="ad62" class="graf graf--p graf--startsWithDoubleQuote graf-after--p">“I do see the duplicates you wrote in v2 lol”</p><p name="eaeb" id="eaeb" class="graf graf--p graf-after--p">(Sometimes I try to remind the bots that these discoveries of theirs are often their own heedless work from earlier in the same session, but they are oblivious to the digs.)</p><p name="5b52" id="5b52" class="graf graf--p graf-after--p">That should have been a signal. When you’re finding duplicates in fundamental type definitions, it usually means something more systematic is wrong. But we were in fix-it mode, so we patched the symptom and kept going.</p><p name="10b9" id="10b9" class="graf graf--p graf-after--p">Sometimes the most dangerous response to a simple error is a simple fix that doesn’t address why the error happened.</p><p name="7724" id="7724" class="graf graf--p graf-after--p">For some reason I am reminded of my first car (a pristine 1969 Mercedes 250 I got for $1400), which was leaking oil, so I gunned it to get over the Bay Bridge, threw a rod, and ended up talking to a nice military guard about why I had rolled down the offramp to the gates of the old base on Treasure Island, but I digress.</p><h3 name="4c4a" id="4c4a" class="graf graf--h3 graf-after--p">The second red flag: missing imports</h3><p name="3cd6" id="3cd6" class="graf graf--p graf-after--h3">Fixed the duplicates, ran the script again. Now it couldn’t find the SQLAlchemy models we’d supposedly created. Checked the files — the models literally weren’t there. We’d been debugging import errors for code that didn’t exist.</p><p name="f346" id="f346" class="graf graf--p graf-after--p">This is where Claude started getting creative with solutions. Maybe we could generate the models dynamically? Or import them from a different location? Or restructure the module exports?</p><p name="d3d9" id="d3d9" class="graf graf--p graf-after--p">Each suggestion was technically valid. Each one was also moving further away from our established patterns. My spidey sense was tingling but not hard enough.</p><h3 name="b2ae" id="b2ae" class="graf graf--h3 graf-after--p">The third red flag: circular imports</h3><p name="189a" id="189a" class="graf graf--p graf-after--h3">Once we actually added the missing models, we hit the classic circular import trap (how does this keep happening!?):</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="5d8c" id="5d8c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment"># Database layer trying to import from domain layer (WRONG DIRECTION)</span><br /><span class="hljs-keyword">from</span> services.domain.models <span class="hljs-keyword">import</span> Project<br /><br /><span class="hljs-comment"># Domain layer had mixed concerns (SQLAlchemy + business logic)</span><br /><span class="hljs-keyword">from</span> sqlalchemy <span class="hljs-keyword">import</span> Column, String</span></pre><p name="2b24" id="2b24" class="graf graf--p graf-after--pre">This is when I knew we needed to stop and reset. Not because the problems were technically difficult — circular imports have standard solutions. But because we’d been systematically violating our own architectural principles while chasing tactical fixes.</p><h3 name="8008" id="8008" class="graf graf--h3 graf-after--p">The intervention</h3><p name="5083" id="5083" class="graf graf--p graf--startsWithDoubleQuote graf-after--h3">“Take a step back. Are we following the stated principles?”</p><p name="d4bc" id="d4bc" class="graf graf--p graf-after--p">That question stopped the tactical spiral immediately. Because once I asked it, the answer was obviously no.</p><p name="152c" id="152c" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">The Piper Mantra</strong>: Domain-first design, clean layer separation, business logic drives technical decisions</p><p name="6bc0" id="6bc0" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">What we were actually doing</strong>: Database layer importing from domain layer, mixed concerns everywhere, technical convenience driving architectural choices</p><p name="a335" id="a335" class="graf graf--p graf-after--p">Sometimes the most productive thing you can do is admit your systematic approach has become unsystematic.</p><h3 name="91ff" id="91ff" class="graf graf--h3 graf-after--p">Architectural course correction</h3><p name="8a34" id="8a34" class="graf graf--p graf-after--h3">Once we recognized we’d drifted from principles, the fixes became obvious:</p><p name="b80a" id="b80a" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Domain models</strong>: Pure business logic only. No SQLAlchemy imports, no database concerns, just dataclasses with business methods.</p><p name="dbf8" id="dbf8" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Database models</strong>: Pure persistence only. SQLAlchemy models that handle storage, with explicit conversion methods to/from domain objects.</p><p name="dd89" id="dd89" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Import flow</strong>: Domain → Service → Repository → Database. Never the reverse.</p><p name="b4a2" id="b4a2" class="graf graf--p graf-after--p">This wasn’t just theoretical purity — it solved the circular import problem immediately. When layers have clear boundaries and uni-directional dependencies, circular imports become impossible.</p><h3 name="78c1" id="78c1" class="graf graf--h3 graf-after--p">The “test-first seduction” trap</h3><p name="8ad3" id="8ad3" class="graf graf--p graf-after--h3">What struck me about this debugging session was how Claude had gotten caught up in making tests pass rather than following architecture. The tests expected certain import patterns, so the solution seemed to be making those imports work.</p><p name="411b" id="411b" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Test-first seduction</strong>: When you optimize for test compatibility instead of architectural coherence</p><p name="22c8" id="22c8" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Architectural discipline</strong>: When you fix the architecture and then update tests to match</p><p name="069b" id="069b" class="graf graf--p graf-after--p">Claude was supposed to be my architect, supposed to help keep the whole project honest and disciplined. It was right there in the prompt. But Opus acknowledged that it could not resist chasing puzzles and tended to forget its role when absorbed in a tactical issue. Good to know!</p><p name="4a21" id="4a21" class="graf graf--p graf-after--p">Tests validate behavior, but they shouldn’t drive structure. When tests and architecture conflict, architecture usually wins.</p><h3 name="f731" id="f731" class="graf graf--h3 graf-after--p">The division of labor</h3><p name="b794" id="b794" class="graf graf--p graf-after--h3">One discovery from this session was how effective explicit division of labor could be:</p><p name="b538" id="b538" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Christian</strong>: Architectural steering, principle enforcement, “does this preserve our design?” <br><strong class="markup--strong markup--p-strong">Claude</strong>: Tactical implementation following established patterns<br><strong class="markup--strong markup--p-strong">Cursor assistant</strong>: Mechanical code changes with human review</p><p name="d3b9" id="d3b9" class="graf graf--p graf-after--p">When I gave Cursor the corrected approach and let it make the mechanical changes while I reviewed each one, we moved much faster than when Claude was trying to figure out both the strategic direction and the tactical implementation.</p><h3 name="e79a" id="e79a" class="graf graf--h3 graf-after--p">A dataclass field order lesson</h3><p name="83d9" id="83d9" class="graf graf--p graf-after--h3">During the cleanup, we hit a subtle Python issue: dataclass fields with default values must come after fields without defaults. Who knew?</p><p name="baf5" id="baf5" class="graf graf--p graf-after--p">Our <code class="markup--code markup--p-code">IntegrationType</code> field had no default and needed to be first.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="python" name="54da" id="54da" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment"># Wrong: Fields with defaults before required fields</span><br /><span class="hljs-meta">@dataclass</span><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProjectIntegration</span>:<br />    integration_id: <span class="hljs-built_in">str</span> = field(default_factory=<span class="hljs-keyword">lambda</span>: <span class="hljs-built_in">str</span>(uuid.uuid4()))<br />    <span class="hljs-built_in">type</span>: IntegrationType  <span class="hljs-comment"># No default - must come first!</span><br /><br /><span class="hljs-comment"># Right: Required fields first, defaults after</span><br /><span class="hljs-meta">@dataclass  </span><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">ProjectIntegration</span>:<br />    <span class="hljs-built_in">type</span>: IntegrationType  <span class="hljs-comment"># Required field first</span><br />    integration_id: <span class="hljs-built_in">str</span> = field(default_factory=<span class="hljs-keyword">lambda</span>: <span class="hljs-built_in">str</span>(uuid.uuid4()))</span></pre><p name="34ba" id="34ba" class="graf graf--p graf-after--pre">These kinds of mechanical errors are easy to fix once you know what’s wrong. But they can mask architectural problems if you don’t address root causes first.</p><h3 name="e68e" id="e68e" class="graf graf--h3 graf-after--p">The steering principle</h3><p name="cf0e" id="cf0e" class="graf graf--p graf-after--h3">What this session taught me about AI collaboration is the importance of timely steering. Claude is excellent at tactical problem-solving, but it can chase solutions down rabbit holes if the strategic direction isn’t clear.</p><p name="2103" id="2103" class="graf graf--p graf-after--p">Remembering to steer can help you catch drift at exactly the right moment — after enough exploration to understand the problem, but before too much investment in the wrong approach</p><p name="fbbf" id="fbbf" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">That magic question</strong>: “Are we following our stated principles?” cut through te tactical complexity and refocused uson strategic coherence.</p><h3 name="f4ba" id="f4ba" class="graf graf--h3 graf-after--p">The async context manager fix</h3><p name="9eb6" id="9eb6" class="graf graf--p graf-after--h3">After fixing the architectural issues, we still had one small tactical problem: creating the default project required proper async context management.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="ini" name="aa07" id="aa07" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment"># Wrong: Mixing sync and async patterns</span><br /><span class="hljs-attr">session</span> = db.get_session()<br /><br /><span class="hljs-comment"># Right: Proper async context</span><br /><span class="hljs-attr">session</span> = await db.get_session()</span></pre><p name="b652" id="b652" class="graf graf--p graf-after--pre">But this fix was straightforward because we’d established clean architecture first. When your foundation is solid, tactical fixes don’t spiral into architectural problems.</p><h3 name="9e13" id="9e13" class="graf graf--h3 graf-after--p">The “woohoo!” moment</h3><blockquote name="3acc" id="3acc" class="graf graf--blockquote graf-after--h3">woohoo! ✅ Domain models import cleanly</blockquote><p name="5bd9" id="5bd9" class="graf graf--p graf-after--blockquote">That was the moment when everything clicked. Not just “the code works,” but “the architecture makes sense.” Clean imports, clear boundaries, obvious relationships between components.</p><p name="5c86" id="5c86" class="graf graf--p graf-after--p">Good architecture feels obvious once you achieve it. The complexity disappears because every piece fits where it belongs.</p><h3 name="c7e3" id="c7e3" class="graf graf--h3 graf-after--p">The PostgreSQL port re-discovery</h3><p name="2dd1" id="2dd1" class="graf graf--p graf-after--h3">Oh, and somehow we kept forgetting that my local PostgreSQL database was running on port 5433 instead of the default 5432. We had made this change early on because something else on my Mac was using the default port, but apparently because 5432 is the usual default and LLMs know a lot more about the usual generic case than the situation at hand, every time a new instance of a bot wrote PostgreSQL code it assumed we were using port 5432 and would have to re-discover the truth. What a waste of time!</p><p name="d975" id="d975" class="graf graf--p graf-after--p">Not architecturally significant, but a reminder that environmental assumptions can masquerade as code problems.</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="1ff9" id="1ff9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment"># Wrong assumption</span><br />DATABASE_URL=postgresql://localhost:5432/piper_morgan<br /><br /><span class="hljs-comment"># Actual configuration  </span><br />DATABASE_URL=postgresql://localhost:5433/piper_morgan</span></pre><p name="e6d1" id="e6d1" class="graf graf--p graf-after--pre">Sometimes the most sophisticated debugging leads to the most mundane discoveries.</p><h3 name="85cc" id="85cc" class="graf graf--h3 graf-after--p">The architectural debt lesson</h3><p name="f2c8" id="f2c8" class="graf graf--p graf-after--h3">What this session reinforced is that architectural debt accumulates faster than you think. We’d been making small tactical decisions — mix a little SQLAlchemy into domain models here, import from the wrong layer there — and suddenly we had circular dependencies and confused responsibilities.</p><p name="ac8c" id="ac8c" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Architectural debt</strong>: The compounding cost of tactical decisions that violate design principles</p><p name="016b" id="016b" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Architectural discipline</strong>: Periodic checks to ensure implementation matches intentions</p><p name="260c" id="260c" class="graf graf--p graf-after--p">We all love compounding interest except when we’re the debtor, and nobody loves compounding technical debt!</p><p name="21ea" id="21ea" class="graf graf--p graf-after--p">The earlier you catch architectural drift, the cheaper it is to fix.</p><h3 name="047d" id="047d" class="graf graf--h3 graf-after--p">Systematic vs. tactical approaches</h3><p name="b0f2" id="b0f2" class="graf graf--p graf-after--h3">Throughout this session, there was constant tension between systematic approaches and tactical fixes:</p><p name="890d" id="890d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Tactical</strong>: Make this specific import work, patch this particular error <strong class="markup--strong markup--p-strong">Systematic</strong>: Fix the layer separation, establish proper boundaries</p><p name="cea0" id="cea0" class="graf graf--p graf-after--p">Tactical approaches feel faster because they address immediate symptoms. Systematic approaches <em class="markup--em markup--p-em">are</em> faster because they prevent future problems from accumulating.</p><h3 name="bb73" id="bb73" class="graf graf--h3 graf-after--p">The “architecture checks every 2–3 components” principle</h3><p name="6a51" id="6a51" class="graf graf--p graf-after--h3">One outcome of this session was establishing regular architecture checks as part of the development process. Instead of implementing several components and then checking for drift, check after every 2–3 changes.</p><p name="c058" id="c058" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Questions to ask</strong>: Does this preserve layer flow? Are we following our stated principles? Would this pattern scale to 10x more components?</p><p name="7a55" id="7a55" class="graf graf--p graf-after--p">Early intervention is much cheaper than systematic refactoring after drift has accumulated! We literally wrote this into the guidance docs.</p><h3 name="b098" id="b098" class="graf graf--h3 graf-after--p">Domain-first vindication!</h3><p name="9fa6" id="9fa6" class="graf graf--p graf-after--h3">The course correction vindicated our domain-first approach. Once we cleaned up the layer separation, everything else became straightforward:</p><ul class="postList"><li name="ceb5" id="ceb5" class="graf graf--li graf-after--p">Database models handled persistence concerns only</li><li name="5738" id="5738" class="graf graf--li graf-after--li">Domain models contained business logic only</li><li name="3374" id="3374" class="graf graf--li graf-after--li">Repositories provided clean conversion between layers</li><li name="61b5" id="61b5" class="graf graf--li graf-after--li">Services coordinated between domain and infrastructure</li></ul><p name="e671" id="e671" class="graf graf--p graf-after--li">Clean architecture creates clean development experiences.</p><h3 name="5ee1" id="5ee1" class="graf graf--h3 graf-after--p">Coming to understand the value of environment consistency</h3><p name="db2d" id="db2d" class="graf graf--p graf-after--h3">This session also reinforced the importance of environment consistency for development flow. When you’re debugging complex architectural issues, environmental surprises (like PostgreSQL on the wrong port) multiply the cognitive load exponentially.</p><p name="4cd5" id="4cd5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Environmental complexity</strong>: Docker conflicts, service dependencies, port collisions</p><p name="5ec4" id="5ec4" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Architectural complexity</strong>: Layer boundaries, import dependencies, domain relationships</p><p name="4a07" id="4a07" class="graf graf--p graf-after--p">Both are necessary, but mixing them during debugging creates unnecessary confusion.</p><h3 name="a2c2" id="a2c2" class="graf graf--h3 graf-after--p">The meta-process learning</h3><p name="dec3" id="dec3" class="graf graf--p graf-after--h3">Perhaps the most valuable insight was about the meta-process of architectural development with AI collaboration:</p><p name="0f91" id="0f91" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Phase 1</strong>: Let AI explore tactical solutions to understand problem space <strong class="markup--strong markup--p-strong">Phase 2</strong>: Human intervention to check strategic alignment<br><strong class="markup--strong markup--p-strong">Phase 3</strong>: AI implementation following clarified principles <br><strong class="markup--strong markup--p-strong">Phase 4</strong>: Mechanical execution with human review</p><p name="f1db" id="f1db" class="graf graf--p graf-after--p">This rhythm of exploration → alignment → implementation → review seems to work well for maintaining architectural coherence while leveraging AI capabilities.</p><h3 name="cbd4" id="cbd4" class="graf graf--h3 graf-after--p">Course correction</h3><p name="8430" id="8430" class="graf graf--p graf-after--h3">This architectural course correction set up everything that followed in our PM-009 implementation. The clean layer separation we established here prevented the more dramatic architectural drift that could have led to the kind of systematic recovery challenges we encountered later.</p><p name="402b" id="402b" class="graf graf--p graf-after--p graf--trailing">Good steering prevents crises better than good crisis management.</p></div></div></section><section name="ca89" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="09d8" id="09d8" class="graf graf--p graf--leading"><em class="markup--em markup--p-em">Next on Building Piper Morgan, “Digging Out of the Complexity Hole” — When architectural course correction isn’t enough and you need systematic recovery from accumulated technical debt.</em></p><p name="de77" id="de77" class="graf graf--p graf-after--p graf--trailing"><em class="markup--em markup--p-em">What’s your experience with architectural steering in technical projects? Have you had moments when asking “are we following our principles?” changed the entire direction of implementation? I’d love to hear about your own tactical vs. systematic tensions and how you maintain architectural discipline under pressure.</em></p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@mediajunkie" class="p-author h-card">christian crumlish</a> on <a href="https://medium.com/p/7d71c9e5316d"><time class="dt-published" datetime="2025-07-23T13:50:35.542Z">July 23, 2025</time></a>.</p><p><a href="https://medium.com/@mediajunkie/when-architecture-principles-trump-tactical-convenience-7d71c9e5316d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on October 9, 2025.</p></footer></article></body></html>